"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[990],{8990:function(t,e,i){i.r(e),i.d(e,{CarView:function(){return y},default:function(){return C}});var r=i(7294);function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function o(t,e){if(t){if("string"===typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,n,o=[],s=!0,a=!1;try{for(i=i.call(t);!(s=(r=i.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(h){a=!0,n=h}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=i(2777),l=i(2262),d=i(9499),c=25,u=.025,v={car:"images/car.webp"},f=Object.keys(v).length,m=function(t){return t*Math.PI/180},g=function(t,e){return Math.floor(Math.random()*(e-t))+t},w=function(){function t(e){var i=e.image,r=e.startCenterCoords,n=e.controls,o=void 0===n?{}:n,s=e.mass,l=void 0===s?10:s;(0,h.Z)(this,t),(0,d.Z)(this,"acceleration",100),(0,d.Z)(this,"image",void 0),(0,d.Z)(this,"coordsCenter",[]),(0,d.Z)(this,"prevCoords",[]),(0,d.Z)(this,"currentMoveDir",0),(0,d.Z)(this,"currentSlowdownRate",1),(0,d.Z)(this,"isSlowing",!1),(0,d.Z)(this,"maxrotationDeg",10),(0,d.Z)(this,"maxSpeed",500),(0,d.Z)(this,"mass",void 0),(0,d.Z)(this,"movingTimer",null),(0,d.Z)(this,"rotationDeg",0),(0,d.Z)(this,"rotationSpeed",200),(0,d.Z)(this,"rotationTimer",null),(0,d.Z)(this,"width",22),(0,d.Z)(this,"height",40),(0,d.Z)(this,"slowdown",-50),(0,d.Z)(this,"slowdownRate",8),(0,d.Z)(this,"speed",0),(0,d.Z)(this,"speedReset",-20),this.coordsCenter=r,this.prevCoords=a(this.coordsCenter),this.image=i,this.mass=l,this.addControls(o)}return(0,l.Z)(t,[{key:"getPathCoords",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=s(this.coordsCenter,2),r=i[0],n=i[1],o=r-this.width/2-t,a=n-(this.height-2*this.width/3)-e;return[[o,a],[o+this.width,a],[o+this.width,a+this.height],[o,a+this.height]]}},{key:"makeCoords",value:function(){var t,e,i=this.currentMoveDir*(this.speed*u+this.acceleration*Math.pow(u,2)/2);this.coordsCenter[0]+=Math.sin(m(-(null!==(t=this.rotationDeg)&&void 0!==t?t:0)))*i,this.coordsCenter[1]+=Math.cos(m(-(null!==(e=this.rotationDeg)&&void 0!==e?e:0)))*i,this.speed>=this.maxSpeed&&(this.speed=this.maxSpeed);var r=this.isSlowing?this.slowdown*this.currentSlowdownRate:this.acceleration;this.speed+=r*u,this.speed<0&&(this.speed=0,this.isSlowing=!1)}},{key:"move",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(!this.currentMoveDir||this.speed<=0)&&(this.currentMoveDir=e),this.currentMoveDir&&this.currentMoveDir!==e?this.currentSlowdownRate=this.slowdownRate:this.isSlowing=!1,this.movingTimer||(this.movingTimer=setInterval((function(){t.makeCoords()}),c))}},{key:"rotate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;0===e?(this.rotationTimer&&clearInterval(this.rotationTimer),this.rotationTimer=null):this.rotationTimer||(this.rotationTimer=setInterval((function(){var i;t.speed>0&&(t.rotationDeg=(null!==(i=t.rotationDeg)&&void 0!==i?i:0)+e*t.rotationSpeed*c/1e3)}),c))}},{key:"stop",value:function(){var t=this;this.isSlowing=!0,this.currentSlowdownRate=1,this.movingTimer&&(clearInterval(this.movingTimer),this.movingTimer=null),this.movingTimer=setInterval((function(){t.makeCoords(),t.speed<=0&&(t.movingTimer&&clearInterval(t.movingTimer),t.movingTimer=null)}),c)}},{key:"addControls",value:function(t){var e=this,i=t.up,r=t.down,n=t.left,o=t.right;window.addEventListener("keydown",(function(t){switch(t.code){case i:e.move(-1);break;case r:e.move(1);break;case n:e.rotate(-1);break;case o:e.rotate(1)}})),window.addEventListener("keyup",(function(t){switch(t.code){case i:case r:e.stop();break;case n:case o:e.rotate(0)}}))}},{key:"draw",value:function(t){var e=s(this.getPathCoords.apply(this,a(this.coordsCenter)),1),i=s(e[0],2),r=i[0],n=i[1];t.drawImage(this.image,r,n,this.width,this.height)}}]),t}(),p=i(5893),y=function(){return(0,r.useEffect)((function(){var t=window.document.getElementById("app-canvas"),e=window.document.getElementById("loading");if(t&&e){var i=t.getContext("2d");if(i){t.width=1240,t.height=840,i.fillStyle="#EFEFEF",i.fillRect(0,0,t.width,t.height);var r=f;for(var n in v){var o=n,s=v[o];if("string"===typeof s){var a=new Image;a.src=s,a.onload=function(){e.innerHTML="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430: ".concat(r,"/").concat(f),0===--r&&(e.innerHTML="",l())},v[o]=a}}var h=[{coordsCenter:[g(0,t.width/2),g(0,t.height/2)],radius:g(10,60),fill:"#9e9e9e",draw:function(t){t.beginPath(),t.arc(this.coordsCenter[0],this.coordsCenter[1],this.radius,0,2*Math.PI,!1),t.fillStyle=this.fill,t.fill()},rotationDeg:void 0},{coordsCenter:[g(0,t.width/2),g(0,t.height/2)],radius:g(10,60),fill:"#9e9e9e",draw:function(t){t.beginPath(),t.arc(this.coordsCenter[0],this.coordsCenter[1],this.radius,0,2*Math.PI,!1),t.fillStyle=this.fill,t.fill()},rotationDeg:void 0},new w({image:v.car,startCenterCoords:[620,420],controls:{up:"KeyW",down:"KeyS",left:"KeyA",right:"KeyD"}})]}}function l(){i&&t&&(i.save(),i.resetTransform(),i.fillStyle="#EFEFEF",i.fillRect(0,0,t.width,t.height),i.restore(),h.forEach((function(t){i.save(),i.translate(t.coordsCenter[0],t.coordsCenter[1]),t.rotationDeg&&i.rotate(m(t.rotationDeg)),t.draw(i),i.restore()})),i.save(),i.fillStyle="green",i.fillRect(t.width/2-3,t.height/2-3,6,6),i.restore(),requestAnimationFrame(l))}}),[]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{style:{position:"absolute"},children:"Use A,W,S,D buttons for control car."}),(0,p.jsx)("div",{id:"loading"}),(0,p.jsx)("canvas",{id:"app-canvas"})]})},C=y}}]);